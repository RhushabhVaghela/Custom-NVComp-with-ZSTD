Using CUDA device: NVIDIA GeForce RTX 5080 Laptop GPU
Compute capability: 12.0
Total memory: 16302 MB
========================================
  FSE Advanced Features Test Suite
========================================


========================================
TEST 1: Low Entropy (Repetitive)
========================================

--- Feature 1 & 2: Adaptive + Accurate ---
--- Feature 3: GPU Optimization ---

[DEBUG] >>> ENCODE_FSE_ADVANCED_DEBUG ENTRY <<< input_size=40
[DEBUG] Step 2 Analysis: unique=1 entropy=0.000000 recommended_log=5
[DEBUG] Step 2 Adjusted: table_log=5 table_size=32
[DEBUG] Step 4 Memcpy Prep: dim=65 size=144
[DEBUG] Step 4 Memcpy: dst=0x90ba00200 src=0x578c0dc7d5e0 size=144 max_sym=65
GPU Encode i=11: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=10: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=9: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=8: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=7: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=6: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=5: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=4: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=3: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=2: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=1: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode i=0: sym=65, state_in=32, nbBitsOut=0, val=0, state_out=32, total_bits=0
GPU Encode: Writing initial_state=32 to bitstream (no terminator)

========================================
TEST 2: Medium Entropy (Text)
========================================

--- Feature 1 & 2: Adaptive + Accurate ---
--- Feature 3: GPU Optimization ---

[DEBUG] >>> ENCODE_FSE_ADVANCED_DEBUG ENTRY <<< input_size=45
[DEBUG] Step 2 Analysis: unique=29 entropy=4.441093 recommended_log=5
[DEBUG] Step 2 Adjusted: table_log=5 table_size=32
[DEBUG] Step 4 Memcpy Prep: dim=122 size=258
[DEBUG] Step 4 Memcpy: dst=0x902c00200 src=0x578c0d8efb10 size=258 max_sym=122
GPU Encode i=11: sym=114, state_in=44, nbBitsOut=5, val=12, state_out=49, total_bits=156
GPU Encode i=10: sym=98, state_in=49, nbBitsOut=5, val=17, state_out=33, total_bits=161
GPU Encode i=9: sym=32, state_in=33, nbBitsOut=3, val=1, state_out=32, total_bits=164
GPU Encode i=8: sym=107, state_in=32, nbBitsOut=5, val=0, state_out=48, total_bits=169
GPU Encode i=7: sym=99, state_in=48, nbBitsOut=5, val=16, state_out=56, total_bits=174
GPU Encode i=6: sym=105, state_in=56, nbBitsOut=5, val=24, state_out=34, total_bits=179
GPU Encode i=5: sym=117, state_in=34, nbBitsOut=5, val=2, state_out=54, total_bits=184
GPU Encode i=4: sym=113, state_in=54, nbBitsOut=5, val=22, state_out=58, total_bits=189
GPU Encode i=3: sym=32, state_in=58, nbBitsOut=3, val=2, state_out=55, total_bits=192
GPU Encode i=2: sym=101, state_in=55, nbBitsOut=5, val=23, state_out=38, total_bits=197
GPU Encode i=1: sym=104, state_in=38, nbBitsOut=5, val=6, state_out=43, total_bits=202
GPU Encode i=0: sym=84, state_in=43, nbBitsOut=5, val=11, state_out=51, total_bits=207
GPU Encode: Writing initial_state=32 to bitstream (no terminator)

========================================
TEST 3: High Entropy (Mixed)
========================================

--- Feature 1 & 2: Adaptive + Accurate ---
--- Feature 3: GPU Optimization ---

[DEBUG] >>> ENCODE_FSE_ADVANCED_DEBUG ENTRY <<< input_size=41
[DEBUG] Step 2 Analysis: unique=41 entropy=5.357552 recommended_log=5
[DEBUG] Step 2 Adjusted: table_log=6 table_size=64
[DEBUG] Step 4 Memcpy Prep: dim=121 size=256
[DEBUG] Step 4 Memcpy: dst=0x902c00200 src=0x578c0d8efb10 size=256 max_sym=121
GPU Encode i=11: sym=70, state_in=93, nbBitsOut=5, val=29, state_out=97, total_bits=165
GPU Encode i=10: sym=54, state_in=97, nbBitsOut=5, val=1, state_out=92, total_bits=170
GPU Encode i=9: sym=101, state_in=92, nbBitsOut=6, val=28, state_out=103, total_bits=176
GPU Encode i=8: sym=53, state_in=103, nbBitsOut=5, val=7, state_out=113, total_bits=181
GPU Encode i=7: sym=68, state_in=113, nbBitsOut=5, val=17, state_out=96, total_bits=186
GPU Encode i=6: sym=52, state_in=96, nbBitsOut=5, val=0, state_out=112, total_bits=191
GPU Encode i=5: sym=99, state_in=112, nbBitsOut=6, val=48, state_out=124, total_bits=197
GPU Encode i=4: sym=51, state_in=124, nbBitsOut=5, val=28, state_out=90, total_bits=202
GPU Encode i=3: sym=66, state_in=90, nbBitsOut=5, val=26, state_out=74, total_bits=207
GPU Encode i=2: sym=50, state_in=74, nbBitsOut=5, val=10, state_out=68, total_bits=212
GPU Encode i=1: sym=97, state_in=68, nbBitsOut=6, val=4, state_out=81, total_bits=218
GPU Encode i=0: sym=49, state_in=81, nbBitsOut=5, val=17, state_out=89, total_bits=223
GPU Encode: Writing initial_state=64 to bitstream (no terminator)

========================================
TEST 4: Multi-Table FSE
========================================

Active Tables: 0x9
  ✓ LITERALS table
  ✓ CUSTOM table
Testing FSE roundtrip with 11 bytes of data
Encoding with FSE...

[DEBUG] >>> ENCODE_FSE_ADVANCED_DEBUG ENTRY <<< input_size=11
[DEBUG] Step 2 Analysis: unique=6 entropy=2.299896 recommended_log=5
[DEBUG] Step 2 Adjusted: table_log=5 table_size=32
[DEBUG] Step 4 Memcpy Prep: dim=6 size=26
[DEBUG] Step 4 Memcpy: dst=0x902c00200 src=0x578c0d7a4200 size=26 max_sym=6
GPU Encode i=10: sym=6, state_in=32, nbBitsOut=1, val=0, state_out=49, total_bits=1
GPU Encode i=9: sym=6, state_in=49, nbBitsOut=2, val=1, state_out=36, total_bits=3
GPU Encode i=8: sym=6, state_in=36, nbBitsOut=1, val=0, state_out=54, total_bits=4
GPU Encode i=7: sym=6, state_in=54, nbBitsOut=2, val=2, state_out=40, total_bits=6
GPU Encode i=6: sym=5, state_in=40, nbBitsOut=2, val=0, state_out=39, total_bits=8
GPU Encode i=5: sym=5, state_in=39, nbBitsOut=2, val=3, state_out=34, total_bits=10
GPU Encode i=4: sym=5, state_in=34, nbBitsOut=1, val=0, state_out=62, total_bits=11
GPU Encode i=3: sym=4, state_in=62, nbBitsOut=4, val=14, state_out=38, total_bits=15
GPU Encode i=2: sym=3, state_in=38, nbBitsOut=3, val=6, state_out=42, total_bits=18
GPU Encode i=1: sym=2, state_in=42, nbBitsOut=3, val=2, state_out=60, total_bits=21
GPU Encode i=0: sym=1, state_in=60, nbBitsOut=4, val=12, state_out=32, total_bits=25
GPU Encode: Writing initial_state=32 to bitstream (no terminator)
test_fse_advanced: /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/tests/test_fse_advanced.cu:129: void test_bit_exact_fse_roundtrip(): Assertion `decoded_data[i] == test_data[i]' failed.
