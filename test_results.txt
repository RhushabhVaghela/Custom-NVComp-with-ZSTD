Test project /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/build
      Start  1: test_adaptive_level
      Start  2: test_alternative_allocation_strategies
      Start  3: test_c_api_edge_cases
      Start  4: test_checksum_validation
 1/68 Test  #3: test_c_api_edge_cases ....................   Passed    0.59 sec
      Start  5: test_comprehensive_fallback
 2/68 Test  #2: test_alternative_allocation_strategies ...   Passed    0.61 sec
      Start  6: test_compressible_data
 3/68 Test  #6: test_compressible_data ...................   Passed    0.01 sec
      Start  7: test_correctness
 4/68 Test  #4: test_checksum_validation .................   Passed    1.18 sec
      Start  8: test_coverage_gaps
 5/68 Test  #1: test_adaptive_level ......................   Passed    1.22 sec
      Start  9: test_cuda_zstd_utils_dedicated
 6/68 Test  #5: test_comprehensive_fallback ..............   Passed    0.76 sec
      Start 10: test_data_integrity_comprehensive
 7/68 Test  #9: test_cuda_zstd_utils_dedicated ...........   Passed    0.26 sec
      Start 11: test_dictionary
 8/68 Test  #8: test_coverage_gaps .......................   Passed    0.37 sec
      Start 12: test_dictionary_compression
 9/68 Test #11: test_dictionary ..........................***Failed    0.31 sec

========================================
  Test: Dictionary Training & Usage
========================================

Creating training samples...
Training dictionary (32KB)...
  ✓ Dictionary trained. Size: 32768 bytes.
Compressing *without* dictionary...
  ✗ FAILED: Compression without dictionary

      Start 13: test_dual_mode_roundtrip
10/68 Test #10: test_data_integrity_comprehensive ........   Passed    0.48 sec
      Start 14: test_error_context
11/68 Test #14: test_error_context .......................   Passed    0.01 sec
      Start 15: test_error_handling
12/68 Test #12: test_dictionary_compression ..............   Passed    0.36 sec
      Start 16: test_extended_validation
13/68 Test #15: test_error_handling ......................   Passed    0.49 sec
      Start 17: test_fallback_strategies
14/68 Test #13: test_dual_mode_roundtrip .................***Exception: SegFault  7.23 sec
======================================
Dual Mode Roundtrip & Benchmark Test
======================================
GPU: NVIDIA GeForce RTX 5080 Laptop GPU

=== Dual Mode Roundtrip Test ===

BitstreamKind::NATIVE mode:
  Compress: OK
  Compressed size: 131085 bytes
  Decompress: OK
  Verify: PASSED

Note: RAW mode (RFC 8878 compatible) is planned for future implementation.
      Currently, only NATIVE mode is supported.

--- Decode Benchmarks ---

=== Decode Benchmark: 1 MB ===

      Start 18: test_find_matches_small
15/68 Test  #7: test_correctness .........................   Passed   10.81 sec
      Start 19: test_fse_comprehensive
16/68 Test #18: test_find_matches_small ..................***Failed    2.37 sec
Small find_matches test (1KB)
compress took 146 ms
manager.compress returned status=SUCCESS cudaLast=1

      Start 20: test_gpu_bitstream
17/68 Test #20: test_gpu_bitstream .......................   Passed    2.00 sec
      Start 21: test_gpu_simple
18/68 Test #21: test_gpu_simple ..........................   Passed    0.31 sec
      Start 22: test_hash_chain_only
19/68 Test #22: test_hash_chain_only .....................   Passed    0.28 sec
      Start 23: test_hash_comprehensive
20/68 Test #23: test_hash_comprehensive ..................   Passed    0.22 sec
      Start 24: test_huffman
21/68 Test #24: test_huffman .............................   Passed    0.66 sec
      Start 25: test_inference_api
22/68 Test #19: test_fse_comprehensive ...................***Failed   14.40 sec

========================================
FSE Comprehensive Test Suite
(Consolidated from 16 FSE test files)
========================================
Using CUDA device: NVIDIA GeForce RTX 5080 Laptop GPU
Compute capability: 12.0
Total memory: 16302 MB
  [FAIL] test_fse_normalization: normalize_frequencies_accurate failed
========================================
SUITE 1: Basic FSE Operations
========================================

[TEST] MultiTableFSE Initialization
  [PASS] test_multitable_fse_init

[TEST] FSE Frequency Normalization

========================================
SUITE 2: FSE Roundtrip Tests
========================================

[TEST] FSE Roundtrip (Small Data)
  Encoded 11 bytes -> 30 bytes
[ERROR] ERROR_CUDA_ERROR at /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/src/cuda_zstd_fse.cu:3557 in decode_fse() (CUDA: invalid argument)
  [FAIL] test_fse_roundtrip_small: decode_fse failed

[TEST] FSE Roundtrip (Large Data)
[ERROR] encode_fse_advanced_debug ENTRY: Pre-existing error: invalid argument
  Encoded 262144 bytes -> 248149 bytes (1.06x compression)
[ERROR] ERROR_CUDA_ERROR at /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/src/cuda_zstd_fse.cu:3557 in decode_fse() (CUDA: invalid argument)
  [FAIL] test_fse_roundtrip_large: decode_fse failed

========================================
SUITE 3: Entropy Distribution Tests
========================================

[TEST] FSE Single Symbol (RLE-like)
[ERROR] encode_fse_advanced_debug ENTRY: Pre-existing error: invalid argument
  Single symbol: 1024 -> 146 bytes
  [PASS] test_fse_single_symbol

[TEST] FSE Two Symbols (50/50)
  Two symbols: 1024 -> 276 bytes
  [PASS] test_fse_two_symbols

[TEST] FSE Full Alphabet (256 symbols)
  Full alphabet: 262144 -> 248262 bytes (1.06x)
  [PASS] test_fse_full_alphabet

========================================
SUITE 4: Manager Integration
========================================

[TEST] FSE Manager Integration
  Manager compress: 1048576 -> 69971 bytes (14.99x)
  [PASS] test_fse_manager_integration

========================================
RESULTS: 5/8 tests passed
========================================

      Start 26: test_integration
23/68 Test #25: test_inference_api .......................***Failed   13.00 sec

========================================
CUDA ZSTD - Inference-Ready API Test Suite
========================================

Using CUDA device: NVIDIA GeForce RTX 5080 Laptop GPU
Compute capability: 12.0
Total memory: 16302 MB
========================================
SUITE 1: decompress_to_preallocated Tests
========================================

[TEST] decompress_to_preallocated Basic
  [INFO] Compressed: 262144 -> 16258 bytes
  [INFO] Decompressed: 16258 -> 262144 bytes
    Mismatch at byte 255744
  [FAIL] test_decompress_to_preallocated_basic: Data verification failed

[TEST] decompress_to_preallocated Buffer Reuse (Zipper Pattern)
  [INFO] Allocated single Zipper Buffer: 131072 bytes
  [INFO] Pre-compressed 5 layers
  [INFO] ✓ All 5 layers decompressed into reused buffer
  [PASS] decompress_to_preallocated Buffer Reuse

========================================
SUITE 2: decompress_batch_preallocated Tests
========================================

[TEST] decompress_batch_preallocated Basic
  [INFO] Prepared 4 batch items with pre-allocated outputs
  [INFO] ✓ All 4 items verified
  [PASS] decompress_batch_preallocated Basic

========================================
SUITE 3: decompress_async_no_sync Tests
========================================

[TEST] decompress_async_no_sync Basic
  [INFO] Launch returned in 2.11 ms
  [INFO] Total time (with sync): 2.16 ms
    Mismatch at byte 257026
  [FAIL] test_decompress_async_no_sync_basic: Data verification failed

========================================
SUITE 4: Inference Integration Tests
========================================

[TEST] Inference Workspace Allocation
  [INFO] Workspace size for 1MB compressed / 4MB output: 6291456 bytes
  [INFO] ✓ Allocated 6291456 bytes of workspace
  [INFO] ✓ Workspace freed
  [PASS] Inference Workspace Allocation

[TEST] Full Inference Simulation (Multi-Layer)
  [INFO] Allocated inference workspace: 3145728 bytes
  [INFO] Allocated double buffer (2 x 524288 bytes)
  [FAIL] test_full_inference_simulation: Pre-compression of layer 0 failed

========================================
SUITE 5: Error Handling Tests
========================================

[TEST] Null Parameter Handling
  [INFO] ✓ Null compressed_data handled
  [INFO] ✓ Null output handled
  [INFO] ✓ Null actual_size handled
  [PASS] Null Parameter Handling

[TEST] Buffer Too Small Handling
  [INFO] ✓ Zero capacity handled
  [PASS] Buffer Too Small Handling

========================================
RESULTS: 5/8 tests passed
========================================

      Start 27: test_lz77_comprehensive
24/68 Test #27: test_lz77_comprehensive ..................***Failed    3.72 sec
========================================
Comprehensive LZ77 Testing
========================================
Test: Random 1MB (1048576 bytes)... FAILED: Data mismatch!

      Start 28: test_memory_pool
25/68 Test #17: test_fallback_strategies .................   Passed   29.95 sec
      Start 29: test_metadata_roundtrip
26/68 Test #29: test_metadata_roundtrip ..................   Passed    7.72 sec
      Start 30: test_nvcomp_batch
27/68 Test #30: test_nvcomp_batch ........................***Failed    0.88 sec

========================================
  Test: NvcompV5BatchManager C++ API
========================================

Created NvcompV5BatchManager with level 5
Allocated 114688 KB temp workspace.
Compressing batch of 8 items...
  ✗ FAILED: Batch compress returned ERROR_GENERIC

      Start 31: test_nvcomp_interface
28/68 Test #31: test_nvcomp_interface ....................   Passed    1.43 sec
      Start 32: test_parallel_backtracking
29/68 Test #16: test_extended_validation .................***Failed   40.48 sec
==================================================
   CUDA-ZSTD Extended Validation Test Suite
==================================================

=== Test 5: 256MB Sequential (OOM Verification) ===
Input Size: 256 MB
[DEBUG] Manager initialized
[DEBUG] Input copied to GPU
[DEBUG] Buffers allocated. Temp size: 31014780928
[ERROR] ERROR_CUDA_ERROR at /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/src/cuda_zstd_manager.cu:1865 in compress() (CUDA: invalid argument)
Compression Failed: 4

==================================================
Test Results: 4/5 passed
==================================================

      Start 33: test_parallel_compression
30/68 Test #33: test_parallel_compression ................***Failed    1.22 sec
=== Parallel Compression Test (GPU Path) ===
Input Size: 10 MB
Allocated Workspace: 1129 MB
Compressing...
Compression Successful! Size: 694858 bytes
Ratio: 15.0905
Decompressing...
[ERROR] ERROR_CUDA_ERROR at /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/src/cuda_zstd_sequence.cu:501 in execute_sequences() (CUDA: an illegal memory access was encountered)
Decompression Failed: 4

      Start 34: test_parallel_setup
31/68 Test #32: test_parallel_backtracking ...............   Passed    1.52 sec
      Start 35: test_performance
32/68 Test #34: test_parallel_setup ......................   Passed    0.29 sec
      Start 36: test_pipeline_integration
33/68 Test #26: test_integration .........................***Exception: SegFault 20.95 sec

========================================
CUDA ZSTD - Integration & Stress Test Suite
========================================

Using CUDA device: NVIDIA GeForce RTX 5080 Laptop GPU
Compute capability: 12.0
Total memory: 16302 MB
========================================
SUITE 1: End-to-End Pipeline Tests
========================================

[TEST] Complete Compression Pipeline
  [INFO] Testing complete pipeline: input -> compress -> decompress -> verify
  [INFO] Allocating memory...
  [INFO] Copying input to device...
  [INFO] Creating manager...
  [INFO] Getting temp size...
  [INFO] Temp size: 121634816
  [INFO] Compressing...
  [INFO] ✓ Compression: 1048576 -> 65171 bytes
  [FAIL] test_complete_compression_pipeline: Size mismatch

[TEST] Dictionary Integration
  [INFO] ✓ Dictionary trained (16384 bytes)
DEBUG: Creating Manager
DEBUG: Setting Dictionary
DEBUG: Dictionary Set
DEBUG: Compressing...
DEBUG: Compression returned status 0
  [INFO] ✓ Compressed with dictionary: 131072 -> 10071
  [INFO] ✓ Decompressed with dictionary
  [INFO] ✓ Dictionary compression verified
  [PASS] Dictionary Integration

[TEST] Batch Processing with Memory Pool
  [INFO] Processing 10 items of 64 KB each
  [INFO] ✓ Batch compressed
  [INFO] Item 0: 65536 -> 4534 bytes
  [INFO] Item 1: 65536 -> 4357 bytes
  [INFO] Item 2: 65536 -> 4858 bytes
  [INFO] Item 3: 65536 -> 4649 bytes
  [INFO] Item 4: 65536 -> 4823 bytes
  [INFO] Item 5: 65536 -> 4353 bytes
  [INFO] Item 6: 65536 -> 4807 bytes
  [INFO] Item 7: 65536 -> 4380 bytes
  [INFO] Item 8: 65536 -> 4988 bytes
  [INFO] Item 9: 65536 -> 4582 bytes
  [INFO] Pool stats - Allocations: 21, Hit rate: 76.1905%
  [PASS] Batch Processing with Memory Pool

========================================
SUITE 2: Large File Tests
========================================

[TEST] Large File Compression (100MB)
  [INFO] File size: 100 MB
  [INFO] Processing in 4 MB chunks
  [INFO] Progress: 10/25 chunks, 2 MB compressed
  [INFO] Progress: 20/25 chunks, 4 MB compressed
  [INFO] Progress: 25/25 chunks, 6 MB compressed
  [INFO] Total compressed: 6 MB
  [INFO] Compression ratio: 16.11:1
  [INFO] Time: 13.48 seconds
  [INFO] Throughput: 7.4 MB/s
  [PASS] Large File Compression

[TEST] Memory Efficiency for Large Files
  [INFO] Free memory before: 14887 MB
  [INFO] Free memory after: 14655 MB
  [INFO] Memory delta: 232 MB
  [FAIL] test_memory_efficiency_large_file: Memory leak detected

========================================
SUITE 3: Multi-threaded Tests
========================================

[TEST] Concurrent Compression Operations
  [INFO] Testing with 4 threads
  [INFO] Each performing 20 compressions
[ERROR] Block 0: compress_literals launch error: invalid argument
[ERROR] ERROR_CUDA_ERROR at /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/src/cuda_zstd_manager.cu:2024 in compress() (CUDA: invalid argument)

      Start 37: test_roundtrip
34/68 Test #37: test_roundtrip ...........................***Failed    1.18 sec

========================================
  Test: Round-Trip (Compress/Decompress)
========================================

Compressing 1MB with level 5...
  Compressed size: 71894 bytes.
Decompressing...
  Decompressed size: 1049568 bytes.
  ✗ FAILED: Size mismatch. Original=1048576, Decompressed=1049568

Test complete. Result: FAILED ✗

      Start 38: test_sequence_encoder
35/68 Test #28: test_memory_pool .........................   Passed   17.49 sec
      Start 39: test_stream_pool
36/68 Test #38: test_sequence_encoder ....................   Passed    3.26 sec
      Start 40: test_streaming
37/68 Test #35: test_performance .........................***Failed    8.21 sec

========================================
CUDA ZSTD - Performance & Profiling Test Suite
========================================

Using CUDA device: NVIDIA GeForce RTX 5080 Laptop GPU
Compute capability: 12.0
Total memory: 16302 MB
========================================
SUITE 1: Component Timing
========================================

[TEST] Compression Timing Breakdown
  [INFO] === Timing Breakdown ===
  [INFO] Total time: 69.05 ms
  [INFO] LZ77 time: 0.00 ms
  [INFO] FSE encode time: 0.00 ms
  [INFO] Huffman encode time: 0.00 ms
  [INFO] Sequence generation: 0.00 ms
  [INFO] Component sum: 0.00 ms
  [INFO] Overhead: 69.05 ms
  [PASS] Compression Timing Breakdown

[TEST] Decompression Timing
  [INFO] Compressed: 1048576 -> 66858 bytes
  [FAIL] test_decompression_timing: Decompression failed

========================================
SUITE 2: Throughput Metrics
========================================

[TEST] Compression Throughput Across Levels

  Level | Time (ms) | Throughput (MB/s) | Ratio | Size (KB)
  ------|-----------|-------------------|-------|----------
      1 |     74.92 |              53.4 | 15.89 |      257
[ERROR] Block 31: write_block failed with status 7
      3 | ERROR | - | - | -
[ERROR] Block 31: write_block failed with status 7
      5 | ERROR | - | - | -
[ERROR] Block 31: write_block failed with status 7
      9 | ERROR | - | - | -
[ERROR] Block 31: write_block failed with status 7
     15 | ERROR | - | - | -
     19 |   2596.19 |               1.5 | 15.95 |      256
  [PASS] Compression Throughput

[TEST] Decompression Throughput
  [INFO] Average decompression time: 40.75 ms
  [INFO] Decompression throughput: 98.2 MB/s
  [PASS] Decompression Throughput

[TEST] Memory Bandwidth Measurement
  [INFO] === Memory Bandwidth ===
  [INFO] Read bandwidth: 0.00 GB/s
  [INFO] Write bandwidth: 0.00 GB/s
  [INFO] Total bandwidth: 0.00 GB/s
  [PASS] Memory Bandwidth

========================================
SUITE 3: Profiling API Tests
========================================

[TEST] Profiler Enable/Disable
  [INFO] Initially enabled: no
  [FAIL] test_profiler_enable_disable: Should be enabled

[TEST] Named Timer Accuracy
  [INFO] Named timer 'test_operation': 0.00 ms
  [FAIL] test_named_timers: Timer should be ~100ms

[TEST] Metrics Reset
  [INFO] Before reset - total time: 0.00 ms
  [INFO] After reset - total time: 0.00 ms
  [INFO] ✓ Metrics reset successfully
  [PASS] Metrics Reset

[TEST] CSV Export Functionality
  [FAIL] test_csv_export: CSV file should be created

[TEST] JSON Export Functionality
  [FAIL] test_json_export: JSON file should be created

========================================
SUITE 4: Optimization Validation
========================================

[TEST] Memory Pool Performance Impact
[ERROR] Block 15: write_block failed with status 7
  [FAIL] test_memory_pool_performance_impact: Compression iteration 1 failed

========================================
TEST RESULTS
========================================
Passed: 5/11
Failed: 6/11

✗ SOME TESTS FAILED
========================================


      Start 41: test_streaming_integration
38/68 Test #39: test_stream_pool .........................   Passed    3.33 sec
      Start 42: test_streaming_unit
39/68 Test #42: test_streaming_unit ......................   Passed    0.74 sec
      Start 43: test_two_phase_unit
40/68 Test #43: test_two_phase_unit ......................***Failed    0.50 sec
========================================
Two-Phase Architecture Unit Tests
========================================
Running test_basic_roundtrip...
  FAILED: compress error, status=7
Running test_multi_block...
  FAILED: compress error, status=7
========================================
2 tests FAILED!
========================================

      Start 44: test_utils
41/68 Test #44: test_utils ...............................   Passed    0.34 sec
      Start 45: test_workspace_patterns
42/68 Test #45: test_workspace_patterns ..................   Passed    0.51 sec
      Start 46: test_workspace_usage
43/68 Test #46: test_workspace_usage .....................   Passed    0.51 sec
      Start 47: test_c_api
44/68 Test #41: test_streaming_integration ...............   Passed    3.56 sec
      Start 48: fixed_benchmark
45/68 Test #47: test_c_api ...............................   Passed    0.67 sec
      Start 49: limited_benchmark
46/68 Test #40: test_streaming ...........................   Passed    6.56 sec
      Start 50: comprehensive_benchmark
47/68 Test #36: test_pipeline_integration ................***Timeout 330.25 sec
Running Pipeline Integration Tests...
sh: 1: zstd: not found
[TEST] Small Data (Data: 16 MB, Batch: 64 MB)... FAIL (ZSTD Integrity Check Failed)

      Start 51: benchmark_lz77
48/68 Test #51: benchmark_lz77 ...........................   Passed   26.76 sec
      Start 52: benchmark_parallel_throughput
49/68 Test #52: benchmark_parallel_throughput ............   Passed  313.33 sec
      Start 53: benchmark_memory_alloc
50/68 Test #53: benchmark_memory_alloc ...................   Passed    0.83 sec
      Start 54: benchmark_pipeline
