========================================
Compressible Data Validation Tests
========================================

Objective: Prove system DOES compress when given compressible data
Context: benchmark_lz77 showed 'zero sequences' with random data


=== Testing: JSON Pattern (64KB) ===
Input size: 65536 bytes
[DEBUG] test_compression: d_compressed allocated at 0x90ba10000
[DIAG] get_compress_temp_size: input=65536, total=11534336
[DIAG] get_compress_temp_size: input=65536, total=11534336
[DEBUG] compress: input_ptr=0x90ba00000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x90ba10000, max_size=131072
[DIAG] compress: temp_size=11534336, total_used=7407104, remaining=4127232
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=65536, num_blocks=1, input_size=65536
[DIAG] Element offset calculation: block_idx * block_size = 0 * 65536 = 0
[DIAG] call_workspace.d_matches base = 0x90bf80000
[DIAG] call_workspace.d_costs base = 0x90c080000
[DIAG] block_ws.d_matches (after offset) = 0x90bf80000
[DIAG] block_ws.d_costs (after offset) = 0x90c080000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x90bf80000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x90c080000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x90bf80000
[DIAG] d_match_lengths = 0x90c000000
[DIAG] d_offsets = 0x90c080000
[DIAG] d_sequences = 0x90c6d0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[DEBUG] Block 0: num_seq=3135, total_literals=7414

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x90bf80000
[PHASE2-START] d_match_lengths = 0x90c000000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=3135\n[DEBUG] First 5 sequences: [LL=29,ML=8,OF=16] [LL=129,ML=3,OF=16] [LL=355,ML=10,OF=462] [LL=1,ML=13,OF=462] [LL=55,ML=11,OF=264] 
[DEBUG] Pointers: d_lit=0x90bf80000, d_match=0x90c000000, d_off=0x90c080000, d_seq=0x90c6d0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=1048576
[DEBUG] build_sequences: d_sequences=0x90c6d0600, d_num_sequences=0x90c290080
[DEBUG] build_sequences: d_sequences=0x90c6d0600, d_num_sequences=0x90c290080
❌ Decompression failed: 5
✅ JSON pattern test PASSED

=== Testing: RLE Pattern (1KB) ===
Input size: 1024 bytes
[DEBUG] test_compression: d_compressed allocated at 0x90bbe0400
[DIAG] get_compress_temp_size: input=1024, total=7340032
[DIAG] get_compress_temp_size: input=1024, total=7340032
[DEBUG] compress: input_ptr=0x90bbe0000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x90bbe0400, max_size=2048
[DIAG] compress: temp_size=7340032, total_used=3729920, remaining=3610112
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=1024, num_blocks=1, input_size=1024
[DIAG] Element offset calculation: block_idx * block_size = 0 * 1024 = 0
[DIAG] call_workspace.d_matches base = 0x90c380000
[DIAG] call_workspace.d_costs base = 0x90c384000
[DIAG] block_ws.d_matches (after offset) = 0x90c380000
[DIAG] block_ws.d_costs (after offset) = 0x90c384000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x90c380000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x90c384000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x90c380000
[DIAG] d_match_lengths = 0x90c400000
[DIAG] d_offsets = 0x90c384000
[DIAG] d_sequences = 0x90c74ea00
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[BACKTRACK] Valid Large Match: Len=1023, Offset=1, Pos=1
[DEBUG] Block 0: num_seq=1, total_literals=1

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x90c380000
[PHASE2-START] d_match_lengths = 0x90c400000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=1,ML=1023,OF=1] 
[DEBUG] Pointers: d_lit=0x90c380000, d_match=0x90c400000, d_off=0x90c384000, d_seq=0x90c74ea00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=16384
[DEBUG] build_sequences: d_sequences=0x90c74ea00, d_num_sequences=0x90c38c480
[DEBUG] build_sequences: d_sequences=0x90c74ea00, d_num_sequences=0x90c38c480
❌ Decompression failed: 5
[ERROR] RLE Compression failed!

=== Testing: Periodic Pattern (64KB) ===
Input size: 65536 bytes
[DEBUG] test_compression: d_compressed allocated at 0x90bbe0000
[DIAG] get_compress_temp_size: input=65536, total=11534336
[DIAG] get_compress_temp_size: input=65536, total=11534336
[DEBUG] compress: input_ptr=0x90ba20000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x90bbe0000, max_size=131072
[DIAG] compress: temp_size=11534336, total_used=7407104, remaining=4127232
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=65536, num_blocks=1, input_size=65536
[DIAG] Element offset calculation: block_idx * block_size = 0 * 65536 = 0
[DIAG] call_workspace.d_matches base = 0x902d80000
[DIAG] call_workspace.d_costs base = 0x902e80000
[DIAG] block_ws.d_matches (after offset) = 0x902d80000
[DIAG] block_ws.d_costs (after offset) = 0x902e80000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x902d80000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x902e80000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x902d80000
[DIAG] d_match_lengths = 0x902e00000
[DIAG] d_offsets = 0x902e80000
[DIAG] d_sequences = 0x9034d0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[BACKTRACK] Valid Large Match: Len=65528, Offset=8, Pos=8
[DEBUG] Block 0: num_seq=1, total_literals=8

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x902d80000
[PHASE2-START] d_match_lengths = 0x902e00000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=8,ML=65528,OF=8] 
[DEBUG] Pointers: d_lit=0x902d80000, d_match=0x902e00000, d_off=0x902e80000, d_seq=0x9034d0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=1048576
[DEBUG] build_sequences: d_sequences=0x9034d0600, d_num_sequences=0x903090080
[DEBUG] build_sequences: d_sequences=0x9034d0600, d_num_sequences=0x903090080
❌ Decompression failed: 5
✅ Periodic pattern test PASSED

=== Testing: Zero-Filled (64KB) ===
Input size: 65536 bytes
[DEBUG] test_compression: d_compressed allocated at 0x90ba20000
[DIAG] get_compress_temp_size: input=65536, total=11534336
[DIAG] get_compress_temp_size: input=65536, total=11534336
[DEBUG] compress: input_ptr=0x90bbe0000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x90ba20000, max_size=131072
[DIAG] compress: temp_size=11534336, total_used=7407104, remaining=4127232
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=65536, num_blocks=1, input_size=65536
[DIAG] Element offset calculation: block_idx * block_size = 0 * 65536 = 0
[DIAG] call_workspace.d_matches base = 0x902d80000
[DIAG] call_workspace.d_costs base = 0x902e80000
[DIAG] block_ws.d_matches (after offset) = 0x902d80000
[DIAG] block_ws.d_costs (after offset) = 0x902e80000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x902d80000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x902e80000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x902d80000
[DIAG] d_match_lengths = 0x902e00000
[DIAG] d_offsets = 0x902e80000
[DIAG] d_sequences = 0x9034d0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[BACKTRACK] Valid Large Match: Len=65535, Offset=1, Pos=1
[DEBUG] Block 0: num_seq=1, total_literals=1

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x902d80000
[PHASE2-START] d_match_lengths = 0x902e00000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=1,ML=65535,OF=1] 
[DEBUG] Pointers: d_lit=0x902d80000, d_match=0x902e00000, d_off=0x902e80000, d_seq=0x9034d0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=1048576
[DEBUG] build_sequences: d_sequences=0x9034d0600, d_num_sequences=0x903090080
[DEBUG] build_sequences: d_sequences=0x9034d0600, d_num_sequences=0x903090080
❌ Decompression failed: 5
❌ Zero-filled test FAILED

=== Testing: All Ones (64KB) ===

=== Testing: All Ones Pattern (0xFF) ===
Input size: 65536 bytes
[DEBUG] test_compression: d_compressed allocated at 0x90bbe0000
[DIAG] get_compress_temp_size: input=65536, total=11534336
[DIAG] get_compress_temp_size: input=65536, total=11534336
[DEBUG] compress: input_ptr=0x90ba20000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x90bbe0000, max_size=131072
[DIAG] compress: temp_size=11534336, total_used=7407104, remaining=4127232
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=65536, num_blocks=1, input_size=65536
[DIAG] Element offset calculation: block_idx * block_size = 0 * 65536 = 0
[DIAG] call_workspace.d_matches base = 0x903180000
[DIAG] call_workspace.d_costs base = 0x903280000
[DIAG] block_ws.d_matches (after offset) = 0x903180000
[DIAG] block_ws.d_costs (after offset) = 0x903280000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x903180000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x903280000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x903180000
[DIAG] d_match_lengths = 0x903200000
[DIAG] d_offsets = 0x903280000
[DIAG] d_sequences = 0x9038d0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[BACKTRACK] Valid Large Match: Len=65535, Offset=1, Pos=1
[DEBUG] Block 0: num_seq=1, total_literals=1

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x903180000
[PHASE2-START] d_match_lengths = 0x903200000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=1,ML=65535,OF=1] 
[DEBUG] Pointers: d_lit=0x903180000, d_match=0x903200000, d_off=0x903280000, d_seq=0x9038d0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=1048576
[DEBUG] build_sequences: d_sequences=0x9038d0600, d_num_sequences=0x903490080
[DEBUG] build_sequences: d_sequences=0x9038d0600, d_num_sequences=0x903490080
❌ Decompression failed: 5
[DEBUG] All Ones Result: Size=49, Ratio=0.00
❌ All Ones test FAILED

========================================
Comparative Analysis (1MB each)
========================================

Pattern              |        Input |   Compressed |      Ratio
-------------------------------------------------------------------

=== Testing: Repeated Text ===
Input size: 1048576 bytes
[DEBUG] test_compression: d_compressed allocated at 0x903000000
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DEBUG] compress: input_ptr=0x902c80000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x903000000, max_size=2097152
[DIAG] compress: temp_size=106954752, total_used=74450432, remaining=32504320
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=131072, num_blocks=8, input_size=1048576
[DIAG] Element offset calculation: block_idx * block_size = 0 * 131072 = 0
[DIAG] call_workspace.d_matches base = 0x904200000
[DIAG] call_workspace.d_costs base = 0x905200000
[DIAG] block_ws.d_matches (after offset) = 0x904200000
[DIAG] block_ws.d_costs (after offset) = 0x905200000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x904200000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x905200000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x904200000
[DIAG] d_match_lengths = 0x904280000
[DIAG] d_offsets = 0x905200000
[DIAG] d_sequences = 0x907ec0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[BACKTRACK] Valid Large Match: Len=65536, Offset=180, Pos=682
[BACKTRACK] Valid Large Match: Len=65536, Offset=45, Pos=267
[DEBUG] Block 1: num_seq=81, total_literals=65299
[BACKTRACK] Valid Large Match: Len=65536, Offset=180, Pos=536
[DEBUG] Block 3: num_seq=80, total_literals=65302
[DEBUG] Block 0: num_seq=55, total_literals=65377
[BACKTRACK] Valid Large Match: Len=65536, Offset=450, Pos=576
[BACKTRACK] Valid Large Match: Len=65536, Offset=45, Pos=101
[DEBUG] Block 6: num_seq=75, total_literals=65317
[DEBUG] Block 2: num_seq=82, total_literals=65296
[BACKTRACK] Valid Large Match: Len=65536, Offset=90, Pos=293
[BACKTRACK] Valid Large Match: Len=65186, Offset=225, Pos=65886
[BACKTRACK] Valid Large Match: Len=65536, Offset=90, Pos=301
[DEBUG] Block 4: num_seq=144, total_literals=65110
[BACKTRACK] Valid Large Match: Len=65536, Offset=585, Pos=731
[DEBUG] Block 7: num_seq=3, total_literals=347
[DEBUG] Block 5: num_seq=72, total_literals=65326

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x904200000
[PHASE2-START] d_match_lengths = 0x904280000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=55\n[DEBUG] First 5 sequences: [LL=536,ML=65536,OF=180] [LL=34,ML=3,OF=644] [LL=42,ML=3,OF=6989] [LL=132,ML=3,OF=11309] [LL=28,ML=3,OF=1066] 
[DEBUG] Pointers: d_lit=0x904200000, d_match=0x904280000, d_off=0x905200000, d_seq=0x907ec0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=16777216
[DEBUG] build_sequences: d_sequences=0x907ec0600, d_num_sequences=0x907300080
[DEBUG] build_sequences: d_sequences=0x907ec0600, d_num_sequences=0x907300080
[DEBUG] compress: Calling build_sequences for block 1 with num_sequences=81\n[DEBUG] First 5 sequences: [LL=14,ML=3,OF=14] [LL=665,ML=65536,OF=180] [LL=67,ML=3,OF=5251] [LL=11,ML=3,OF=3389] [LL=312,ML=3,OF=2759] 
[DEBUG] Pointers: d_lit=0x904400000, d_match=0x904480000, d_off=0x905300000, d_seq=0x908280800
[DEBUG] Pointer deltas: match-lit=524288, off-lit=15728640
[DEBUG] build_sequences: d_sequences=0x908280800, d_num_sequences=0x90730008c
[DEBUG] build_sequences: d_sequences=0x908280800, d_num_sequences=0x90730008c
[DEBUG] compress: Calling build_sequences for block 2 with num_sequences=82\n[DEBUG] First 5 sequences: [LL=27,ML=3,OF=14] [LL=71,ML=65536,OF=45] [LL=45,ML=3,OF=14] [LL=42,ML=3,OF=14] [LL=28,ML=3,OF=391] 
[DEBUG] Pointers: d_lit=0x904600000, d_match=0x904680000, d_off=0x905400000, d_seq=0x908640a00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=14680064
[DEBUG] build_sequences: d_sequences=0x908640a00, d_num_sequences=0x907300098
[DEBUG] build_sequences: d_sequences=0x908640a00, d_num_sequences=0x907300098
[DEBUG] compress: Calling build_sequences for block 3 with num_sequences=80\n[DEBUG] First 5 sequences: [LL=267,ML=65536,OF=45] [LL=58,ML=3,OF=481] [LL=11,ML=3,OF=14] [LL=28,ML=3,OF=121] [LL=11,ML=3,OF=104] 
[DEBUG] Pointers: d_lit=0x904800000, d_match=0x904880000, d_off=0x905500000, d_seq=0x908a00c00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=13631488
[DEBUG] build_sequences: d_sequences=0x908a00c00, d_num_sequences=0x9073000a4
[DEBUG] build_sequences: d_sequences=0x908a00c00, d_num_sequences=0x9073000a4
[DEBUG] compress: Calling build_sequences for block 4 with num_sequences=144\n[DEBUG] First 5 sequences: [LL=53,ML=3,OF=14] [LL=132,ML=3,OF=14] [LL=73,ML=3,OF=211] [LL=11,ML=3,OF=14] [LL=12,ML=65536,OF=90] 
[DEBUG] Pointers: d_lit=0x904a00000, d_match=0x904a80000, d_off=0x905600000, d_seq=0x908dc0e00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=12582912
[DEBUG] build_sequences: d_sequences=0x908dc0e00, d_num_sequences=0x9073000b0
[DEBUG] build_sequences: d_sequences=0x908dc0e00, d_num_sequences=0x9073000b0
[DEBUG] compress: Calling build_sequences for block 5 with num_sequences=72\n[DEBUG] First 5 sequences: [LL=21,ML=3,OF=14] [LL=707,ML=65536,OF=585] [LL=25,ML=3,OF=4396] [LL=11,ML=3,OF=19364] [LL=73,ML=3,OF=19921] 
[DEBUG] Pointers: d_lit=0x904c00000, d_match=0x904c80000, d_off=0x905700000, d_seq=0x909181000
[DEBUG] Pointer deltas: match-lit=524288, off-lit=11534336
[DEBUG] build_sequences: d_sequences=0x909181000, d_num_sequences=0x9073000bc
[DEBUG] build_sequences: d_sequences=0x909181000, d_num_sequences=0x9073000bc
[DEBUG] compress: Calling build_sequences for block 6 with num_sequences=75\n[DEBUG] First 5 sequences: [LL=576,ML=65536,OF=450] [LL=13,ML=3,OF=4936] [LL=42,ML=3,OF=8131] [LL=11,ML=3,OF=3749] [LL=28,ML=3,OF=7411] 
[DEBUG] Pointers: d_lit=0x904e00000, d_match=0x904e80000, d_off=0x905800000, d_seq=0x909541200
[DEBUG] Pointer deltas: match-lit=524288, off-lit=10485760
[DEBUG] build_sequences: d_sequences=0x909541200, d_num_sequences=0x9073000c8
[DEBUG] build_sequences: d_sequences=0x909541200, d_num_sequences=0x9073000c8
[DEBUG] compress: Calling build_sequences for block 7 with num_sequences=3\n[DEBUG] First 5 sequences: [LL=301,ML=65536,OF=90] [LL=45,ML=3,OF=14] [LL=1,ML=65186,OF=225] 
[DEBUG] Pointers: d_lit=0x905000000, d_match=0x905080000, d_off=0x905900000, d_seq=0x909901400
[DEBUG] Pointer deltas: match-lit=524288, off-lit=9437184
[DEBUG] build_sequences: d_sequences=0x909901400, d_num_sequences=0x9073000d4
[DEBUG] build_sequences: d_sequences=0x909901400, d_num_sequences=0x9073000d4
❌ Decompression failed: 5
Repeated Text        |      1048576 |       464572 |       0.00:1

=== Testing: JSON Pattern ===
Input size: 1048576 bytes
[DEBUG] test_compression: d_compressed allocated at 0x903000000
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DEBUG] compress: input_ptr=0x902c80000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x903000000, max_size=2097152
[DIAG] compress: temp_size=106954752, total_used=74450432, remaining=32504320
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=131072, num_blocks=8, input_size=1048576
[DIAG] Element offset calculation: block_idx * block_size = 0 * 131072 = 0
[DIAG] call_workspace.d_matches base = 0x904600000
[DIAG] call_workspace.d_costs base = 0x905600000
[DIAG] block_ws.d_matches (after offset) = 0x904600000
[DIAG] block_ws.d_costs (after offset) = 0x905600000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x904600000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x905600000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x904600000
[DIAG] d_match_lengths = 0x904680000
[DIAG] d_offsets = 0x905600000
[DIAG] d_sequences = 0x9082c0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
, search_depth=128, hash_log=18[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128

[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[DEBUG] Block 3: num_seq=1990, total_literals=90868
[DEBUG] Block 2: num_seq=1074, total_literals=111460
[DEBUG] Block 6: num_seq=2565, total_literals=77359
[DEBUG] Block 0: num_seq=202, total_literals=128343
[DEBUG] Block 7: num_seq=3165, total_literals=63886
[DEBUG] Block 1: num_seq=3117, total_literals=66233
[DEBUG] Block 4: num_seq=2730, total_literals=74030
[DEBUG] Block 5: num_seq=3084, total_literals=66789

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x904600000
[PHASE2-START] d_match_lengths = 0x904680000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=202\n[DEBUG] First 5 sequences: [LL=29,ML=8,OF=16] [LL=459,ML=3,OF=16] [LL=80,ML=21,OF=198] [LL=28,ML=3,OF=16] [LL=411,ML=3,OF=17] 
[DEBUG] Pointers: d_lit=0x904600000, d_match=0x904680000, d_off=0x905600000, d_seq=0x9082c0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=16777216
[DEBUG] build_sequences: d_sequences=0x9082c0600, d_num_sequences=0x907700080
[DEBUG] build_sequences: d_sequences=0x9082c0600, d_num_sequences=0x907700080
[DEBUG] compress: Calling build_sequences for block 1 with num_sequences=3117\n[DEBUG] First 5 sequences: [LL=21,ML=4,OF=17] [LL=54,ML=3,OF=39] [LL=7,ML=10,OF=56] [LL=16,ML=4,OF=19] [LL=44,ML=3,OF=24] 
[DEBUG] Pointers: d_lit=0x904800000, d_match=0x904880000, d_off=0x905700000, d_seq=0x908680800
[DEBUG] Pointer deltas: match-lit=524288, off-lit=15728640
[DEBUG] build_sequences: d_sequences=0x908680800, d_num_sequences=0x90770008c
[DEBUG] build_sequences: d_sequences=0x908680800, d_num_sequences=0x90770008c
[DEBUG] compress: Calling build_sequences for block 2 with num_sequences=1074\n[DEBUG] First 5 sequences: [LL=50,ML=3,OF=17] [LL=16,ML=3,OF=19] [LL=53,ML=3,OF=17] [LL=16,ML=3,OF=19] [LL=72,ML=3,OF=19] 
[DEBUG] Pointers: d_lit=0x904a00000, d_match=0x904a80000, d_off=0x905800000, d_seq=0x908a40a00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=14680064
[DEBUG] build_sequences: d_sequences=0x908a40a00, d_num_sequences=0x907700098
[DEBUG] build_sequences: d_sequences=0x908a40a00, d_num_sequences=0x907700098
[DEBUG] compress: Calling build_sequences for block 3 with num_sequences=1990\n[DEBUG] First 5 sequences: [LL=19,ML=6,OF=19] [LL=67,ML=8,OF=19] [LL=52,ML=4,OF=17] [LL=15,ML=4,OF=19] [LL=71,ML=4,OF=19] 
[DEBUG] Pointers: d_lit=0x904c00000, d_match=0x904c80000, d_off=0x905900000, d_seq=0x908e00c00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=13631488
[DEBUG] build_sequences: d_sequences=0x908e00c00, d_num_sequences=0x9077000a4
[DEBUG] build_sequences: d_sequences=0x908e00c00, d_num_sequences=0x9077000a4
[DEBUG] compress: Calling build_sequences for block 4 with num_sequences=2730\n[DEBUG] First 5 sequences: [LL=30,ML=4,OF=17] [LL=63,ML=3,OF=24] [LL=5,ML=4,OF=17] [LL=15,ML=4,OF=19] [LL=52,ML=4,OF=17] 
[DEBUG] Pointers: d_lit=0x904e00000, d_match=0x904e80000, d_off=0x905a00000, d_seq=0x9091c0e00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=12582912
[DEBUG] build_sequences: d_sequences=0x9091c0e00, d_num_sequences=0x9077000b0
[DEBUG] build_sequences: d_sequences=0x9091c0e00, d_num_sequences=0x9077000b0
[DEBUG] compress: Calling build_sequences for block 5 with num_sequences=3084\n[DEBUG] First 5 sequences: [LL=59,ML=3,OF=17] [LL=16,ML=3,OF=19] [LL=71,ML=4,OF=19] [LL=40,ML=15,OF=75] [LL=10,ML=10,OF=19] 
[DEBUG] Pointers: d_lit=0x905000000, d_match=0x905080000, d_off=0x905b00000, d_seq=0x909581000
[DEBUG] Pointer deltas: match-lit=524288, off-lit=11534336
[DEBUG] build_sequences: d_sequences=0x909581000, d_num_sequences=0x9077000bc
[DEBUG] build_sequences: d_sequences=0x909581000, d_num_sequences=0x9077000bc
[DEBUG] compress: Calling build_sequences for block 6 with num_sequences=2565\n[DEBUG] First 5 sequences: [LL=63,ML=4,OF=20] [LL=55,ML=3,OF=18] [LL=16,ML=4,OF=20] [LL=74,ML=4,OF=20] [LL=33,ML=6,OF=78] 
[DEBUG] Pointers: d_lit=0x905200000, d_match=0x905280000, d_off=0x905c00000, d_seq=0x909941200
[DEBUG] Pointer deltas: match-lit=524288, off-lit=10485760
[DEBUG] build_sequences: d_sequences=0x909941200, d_num_sequences=0x9077000c8
[DEBUG] build_sequences: d_sequences=0x909941200, d_num_sequences=0x9077000c8
[DEBUG] compress: Calling build_sequences for block 7 with num_sequences=3165\n[DEBUG] First 5 sequences: [LL=23,ML=12,OF=20] [LL=53,ML=5,OF=18] [LL=65,ML=3,OF=25] [LL=7,ML=3,OF=18] [LL=0,ML=3,OF=46] 
[DEBUG] Pointers: d_lit=0x905400000, d_match=0x905480000, d_off=0x905d00000, d_seq=0x909d01400
[DEBUG] Pointer deltas: match-lit=524288, off-lit=9437184
[DEBUG] build_sequences: d_sequences=0x909d01400, d_num_sequences=0x9077000d4
[DEBUG] build_sequences: d_sequences=0x909d01400, d_num_sequences=0x9077000d4
❌ Decompression failed: 5
JSON Pattern         |      1048576 |       894194 |       0.00:1

=== Testing: RLE Pattern ===
Input size: 1048576 bytes
[DEBUG] test_compression: d_compressed allocated at 0x903000000
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DEBUG] compress: input_ptr=0x902c80000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x903000000, max_size=2097152
[DIAG] compress: temp_size=106954752, total_used=74450432, remaining=32504320
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=131072, num_blocks=8, input_size=1048576
[DIAG] Element offset calculation: block_idx * block_size = 0 * 131072 = 0
[DIAG] call_workspace.d_matches base = 0x904a00000
[DIAG] call_workspace.d_costs base = 0x905a00000
[DIAG] block_ws.d_matches (after offset) = 0x904a00000
[DIAG] block_ws.d_costs (after offset) = 0x905a00000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x904a00000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x905a00000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x904a00000
[DIAG] d_match_lengths = 0x904a80000
[DIAG] d_offsets = 0x905a00000
[DIAG] d_sequences = 0x9086c0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Found Large Match: Len=65536, Offset=33, Pos=160
[KERNEL] Found Large Match: Len=65536, Offset=1, Pos=96
[KERNEL] Found Large Match: Len=65536, Offset=1, Pos=192
[KERNEL] Found Large Match: Len=65536, Offset=1, Pos=64
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Found Large Match: Len=65536, Offset=1, Pos=224
[KERNEL] Found Large Match: Len=65536, Offset=1, Pos=96
[KERNEL] Found Large Match: Len=65536, Offset=33, Pos=192
[KERNEL] Found Large Match: Len=65536, Offset=65, Pos=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Found Large Match: Len=65536, Offset=1, Pos=160
[KERNEL] Found Large Match: Len=65536, Offset=161, Pos=224
[KERNEL] Found Large Match: Len=65536, Offset=1, Pos=96
[KERNEL] Found Large Match: Len=65536, Offset=1, Pos=192
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=4999
[DEBUG] Block 2: num_seq=2, total_literals=65536
[BACKTRACK] Valid Large Match: Len=65531, Offset=3541, Pos=65541
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=5
[DEBUG] Block 0: num_seq=2, total_literals=5
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=31
[DEBUG] Block 5: num_seq=2, total_literals=65536
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=4863
[DEBUG] Block 6: num_seq=2, total_literals=65536
[BACKTRACK] Valid Large Match: Len=65534, Offset=3566, Pos=65538
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=2
[DEBUG] Block 3: num_seq=2, total_literals=2
[BACKTRACK] Valid Large Match: Len=65535, Offset=1, Pos=65537
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=1
[DEBUG] Block 7: num_seq=2, total_literals=1
[BACKTRACK] Valid Large Match: Len=65535, Offset=2952, Pos=65537
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=1
[BACKTRACK] Valid Large Match: Len=65535, Offset=3631, Pos=65537
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=1
[DEBUG] Block 4: num_seq=2, total_literals=1
[DEBUG] Block 1: num_seq=2, total_literals=1

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x904a00000
[PHASE2-START] d_match_lengths = 0x904a80000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=5,ML=65536,OF=1] [LL=0,ML=65531,OF=3541] 
[DEBUG] Pointers: d_lit=0x904a00000, d_match=0x904a80000, d_off=0x905a00000, d_seq=0x9086c0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=16777216
[DEBUG] build_sequences: d_sequences=0x9086c0600, d_num_sequences=0x907b00080
[DEBUG] build_sequences: d_sequences=0x9086c0600, d_num_sequences=0x907b00080
[DEBUG] compress: Calling build_sequences for block 1 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=1,ML=65536,OF=1] [LL=0,ML=65535,OF=3631] 
[DEBUG] Pointers: d_lit=0x904c00000, d_match=0x904c80000, d_off=0x905b00000, d_seq=0x908a80800
[DEBUG] Pointer deltas: match-lit=524288, off-lit=15728640
[DEBUG] build_sequences: d_sequences=0x908a80800, d_num_sequences=0x907b0008c
[DEBUG] build_sequences: d_sequences=0x908a80800, d_num_sequences=0x907b0008c
[DEBUG] compress: Calling build_sequences for block 2 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=4999,ML=65536,OF=65537] [LL=60537,ML=0,OF=39] 
[DEBUG] Pointers: d_lit=0x904e00000, d_match=0x904e80000, d_off=0x905c00000, d_seq=0x908e40a00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=14680064
[DEBUG] build_sequences: d_sequences=0x908e40a00, d_num_sequences=0x907b00098
[DEBUG] build_sequences: d_sequences=0x908e40a00, d_num_sequences=0x907b00098
[DEBUG] compress: Calling build_sequences for block 3 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=2,ML=65536,OF=1] [LL=0,ML=65534,OF=3566] 
[DEBUG] Pointers: d_lit=0x905000000, d_match=0x905080000, d_off=0x905d00000, d_seq=0x909200c00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=13631488
[DEBUG] build_sequences: d_sequences=0x909200c00, d_num_sequences=0x907b000a4
[DEBUG] build_sequences: d_sequences=0x909200c00, d_num_sequences=0x907b000a4
[DEBUG] compress: Calling build_sequences for block 4 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=1,ML=65536,OF=1] [LL=0,ML=65535,OF=2952] 
[DEBUG] Pointers: d_lit=0x905200000, d_match=0x905280000, d_off=0x905e00000, d_seq=0x9095c0e00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=12582912
[DEBUG] build_sequences: d_sequences=0x9095c0e00, d_num_sequences=0x907b000b0
[DEBUG] build_sequences: d_sequences=0x9095c0e00, d_num_sequences=0x907b000b0
[DEBUG] compress: Calling build_sequences for block 5 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=31,ML=65536,OF=65537] [LL=65505,ML=0,OF=39] 
[DEBUG] Pointers: d_lit=0x905400000, d_match=0x905480000, d_off=0x905f00000, d_seq=0x909981000
[DEBUG] Pointer deltas: match-lit=524288, off-lit=11534336
[DEBUG] build_sequences: d_sequences=0x909981000, d_num_sequences=0x907b000bc
[DEBUG] build_sequences: d_sequences=0x909981000, d_num_sequences=0x907b000bc
[DEBUG] compress: Calling build_sequences for block 6 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=4863,ML=65536,OF=1] [LL=60673,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905600000, d_match=0x905680000, d_off=0x906000000, d_seq=0x909d41200
[DEBUG] Pointer deltas: match-lit=524288, off-lit=10485760
[DEBUG] build_sequences: d_sequences=0x909d41200, d_num_sequences=0x907b000c8
[DEBUG] build_sequences: d_sequences=0x909d41200, d_num_sequences=0x907b000c8
[DEBUG] compress: Calling build_sequences for block 7 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=1,ML=65536,OF=1] [LL=0,ML=65535,OF=1] 
[DEBUG] Pointers: d_lit=0x905800000, d_match=0x905880000, d_off=0x906100000, d_seq=0x90a101400
[DEBUG] Pointer deltas: match-lit=524288, off-lit=9437184
[DEBUG] build_sequences: d_sequences=0x90a101400, d_num_sequences=0x907b000d4
[DEBUG] build_sequences: d_sequences=0x90a101400, d_num_sequences=0x907b000d4
❌ Decompression failed: 5
RLE Pattern          |      1048576 |       196894 |       0.00:1

=== Testing: Periodic ===
Input size: 1048576 bytes
[DEBUG] test_compression: d_compressed allocated at 0x903000000
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DEBUG] compress: input_ptr=0x902c80000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x903000000, max_size=2097152
[DIAG] compress: temp_size=106954752, total_used=74450432, remaining=32504320
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=131072, num_blocks=8, input_size=1048576
[DIAG] Element offset calculation: block_idx * block_size = 0 * 131072 = 0
[DIAG] call_workspace.d_matches base = 0x904e00000
[DIAG] call_workspace.d_costs base = 0x905e00000
[DIAG] block_ws.d_matches (after offset) = 0x904e00000
[DIAG] block_ws.d_costs (after offset) = 0x905e00000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x904e00000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x905e00000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x904e00000
[DIAG] d_match_lengths = 0x904e80000
[DIAG] d_offsets = 0x905e00000
[DIAG] d_sequences = 0x908ac0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[BACKTRACK] Valid Large Match: Len=65528, Offset=8, Pos=65544
[BACKTRACK] Valid Large Match: Len=65536, Offset=8, Pos=8
[DEBUG] Block 2: num_seq=2, total_literals=8
[BACKTRACK] Valid Large Match: Len=65527, Offset=35208, Pos=65545
[BACKTRACK] Valid Large Match: Len=65536, Offset=8, Pos=9
[DEBUG] Block 0: num_seq=2, total_literals=9
[BACKTRACK] Valid Large Match: Len=65536, Offset=8, Pos=31
[DEBUG] Block 6: num_seq=2, total_literals=65536
[BACKTRACK] Valid Large Match: Len=65522, Offset=19240, Pos=65550
[BACKTRACK] Valid Large Match: Len=65536, Offset=8, Pos=14
[BACKTRACK] Valid Large Match: Len=65528, Offset=8, Pos=65544
[BACKTRACK] Valid Large Match: Len=65536, Offset=8, Pos=8
[DEBUG] Block 4: num_seq=2, total_literals=14
[DEBUG] Block 7: num_seq=2, total_literals=8
[BACKTRACK] Valid Large Match: Len=65528, Offset=8, Pos=65544
[BACKTRACK] Valid Large Match: Len=65536, Offset=8, Pos=8
[BACKTRACK] Valid Large Match: Len=65528, Offset=10928, Pos=65544
[BACKTRACK] Valid Large Match: Len=65536, Offset=8, Pos=8
[BACKTRACK] Valid Large Match: Len=65536, Offset=8, Pos=4124
[DEBUG] Block 5: num_seq=2, total_literals=8
[DEBUG] Block 3: num_seq=2, total_literals=8
[DEBUG] Block 1: num_seq=2, total_literals=65536

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x904e00000
[PHASE2-START] d_match_lengths = 0x904e80000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=9,ML=65536,OF=8] [LL=0,ML=65527,OF=35208] 
[DEBUG] Pointers: d_lit=0x904e00000, d_match=0x904e80000, d_off=0x905e00000, d_seq=0x908ac0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=16777216
[DEBUG] build_sequences: d_sequences=0x908ac0600, d_num_sequences=0x907f00080
[DEBUG] build_sequences: d_sequences=0x908ac0600, d_num_sequences=0x907f00080
[DEBUG] compress: Calling build_sequences for block 1 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=4124,ML=65536,OF=8] [LL=61412,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905000000, d_match=0x905080000, d_off=0x905f00000, d_seq=0x908e80800
[DEBUG] Pointer deltas: match-lit=524288, off-lit=15728640
[DEBUG] build_sequences: d_sequences=0x908e80800, d_num_sequences=0x907f0008c
[DEBUG] build_sequences: d_sequences=0x908e80800, d_num_sequences=0x907f0008c
[DEBUG] compress: Calling build_sequences for block 2 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=8,ML=65536,OF=8] [LL=0,ML=65528,OF=8] 
[DEBUG] Pointers: d_lit=0x905200000, d_match=0x905280000, d_off=0x906000000, d_seq=0x909240a00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=14680064
[DEBUG] build_sequences: d_sequences=0x909240a00, d_num_sequences=0x907f00098
[DEBUG] build_sequences: d_sequences=0x909240a00, d_num_sequences=0x907f00098
[DEBUG] compress: Calling build_sequences for block 3 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=8,ML=65536,OF=8] [LL=0,ML=65528,OF=10928] 
[DEBUG] Pointers: d_lit=0x905400000, d_match=0x905480000, d_off=0x906100000, d_seq=0x909600c00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=13631488
[DEBUG] build_sequences: d_sequences=0x909600c00, d_num_sequences=0x907f000a4
[DEBUG] build_sequences: d_sequences=0x909600c00, d_num_sequences=0x907f000a4
[DEBUG] compress: Calling build_sequences for block 4 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=14,ML=65536,OF=65544] [LL=0,ML=65522,OF=100] 
[DEBUG] Pointers: d_lit=0x905600000, d_match=0x905680000, d_off=0x906200000, d_seq=0x9099c0e00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=12582912
[DEBUG] build_sequences: d_sequences=0x9099c0e00, d_num_sequences=0x907f000b0
[DEBUG] build_sequences: d_sequences=0x9099c0e00, d_num_sequences=0x907f000b0
[DEBUG] compress: Calling build_sequences for block 5 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=8,ML=65536,OF=8] [LL=0,ML=65528,OF=8] 
[DEBUG] Pointers: d_lit=0x905800000, d_match=0x905880000, d_off=0x906300000, d_seq=0x909d81000
[DEBUG] Pointer deltas: match-lit=524288, off-lit=11534336
[DEBUG] build_sequences: d_sequences=0x909d81000, d_num_sequences=0x907f000bc
[DEBUG] build_sequences: d_sequences=0x909d81000, d_num_sequences=0x907f000bc
[DEBUG] compress: Calling build_sequences for block 6 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=31,ML=65536,OF=65544] [LL=65505,ML=0,OF=90] 
[DEBUG] Pointers: d_lit=0x905a00000, d_match=0x905a80000, d_off=0x906400000, d_seq=0x90a141200
[DEBUG] Pointer deltas: match-lit=524288, off-lit=10485760
[DEBUG] build_sequences: d_sequences=0x90a141200, d_num_sequences=0x907f000c8
[DEBUG] build_sequences: d_sequences=0x90a141200, d_num_sequences=0x907f000c8
[DEBUG] compress: Calling build_sequences for block 7 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=8,ML=65536,OF=8] [LL=0,ML=65528,OF=8] 
[DEBUG] Pointers: d_lit=0x905c00000, d_match=0x905c80000, d_off=0x906500000, d_seq=0x90a501400
[DEBUG] Pointer deltas: match-lit=524288, off-lit=9437184
[DEBUG] build_sequences: d_sequences=0x90a501400, d_num_sequences=0x907f000d4
[DEBUG] build_sequences: d_sequences=0x90a501400, d_num_sequences=0x907f000d4
❌ Decompression failed: 5
Periodic             |      1048576 |       131401 |       0.00:1

=== Testing: Zeros ===
Input size: 1048576 bytes
[DEBUG] test_compression: d_compressed allocated at 0x903000000
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DEBUG] compress: input_ptr=0x903f00000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x903000000, max_size=2097152
[DIAG] compress: temp_size=106954752, total_used=74450432, remaining=32504320
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=131072, num_blocks=8, input_size=1048576
[DIAG] Element offset calculation: block_idx * block_size = 0 * 131072 = 0
[DIAG] call_workspace.d_matches base = 0x905200000
[DIAG] call_workspace.d_costs base = 0x906200000
[DIAG] block_ws.d_matches (after offset) = 0x905200000
[DIAG] block_ws.d_costs (after offset) = 0x906200000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x905200000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x906200000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x905200000
[DIAG] d_match_lengths = 0x905280000
[DIAG] d_offsets = 0x906200000
[DIAG] d_sequences = 0x908ec0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Found Large Match: Len=65536, Offset=65, Pos=128
[KERNEL] Found Large Match: Len=65536, Offset=1, Pos=160
[KERNEL] Found Large Match: Len=65536, Offset=33, Pos=224
[KERNEL] Found Large Match: Len=65536, Offset=65, Pos=192
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=3073
[DEBUG] Block 6: num_seq=2, total_literals=65536
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=31
[DEBUG] Block 0: num_seq=2, total_literals=65536
[BACKTRACK] Valid Large Match: Len=65535, Offset=1, Pos=65537
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=1
[DEBUG] Block 7: num_seq=2, total_literals=1
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=4999
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=4999
[DEBUG] Block 1: num_seq=2, total_literals=65536
[DEBUG] Block 5: num_seq=2, total_literals=65536
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=4999
[DEBUG] Block 4: num_seq=2, total_literals=65536
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=31
[DEBUG] Block 2: num_seq=2, total_literals=65536
[BACKTRACK] Valid Large Match: Len=65536, Offset=1, Pos=31
[DEBUG] Block 3: num_seq=2, total_literals=65536

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x905200000
[PHASE2-START] d_match_lengths = 0x905280000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=31,ML=65536,OF=1] [LL=65505,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905200000, d_match=0x905280000, d_off=0x906200000, d_seq=0x908ec0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=16777216
[DEBUG] build_sequences: d_sequences=0x908ec0600, d_num_sequences=0x908300080
[DEBUG] build_sequences: d_sequences=0x908ec0600, d_num_sequences=0x908300080
[DEBUG] compress: Calling build_sequences for block 1 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=4999,ML=65536,OF=1] [LL=60537,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905400000, d_match=0x905480000, d_off=0x906300000, d_seq=0x909280800
[DEBUG] Pointer deltas: match-lit=524288, off-lit=15728640
[DEBUG] build_sequences: d_sequences=0x909280800, d_num_sequences=0x90830008c
[DEBUG] build_sequences: d_sequences=0x909280800, d_num_sequences=0x90830008c
[DEBUG] compress: Calling build_sequences for block 2 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=31,ML=65536,OF=1] [LL=65505,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905600000, d_match=0x905680000, d_off=0x906400000, d_seq=0x909640a00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=14680064
[DEBUG] build_sequences: d_sequences=0x909640a00, d_num_sequences=0x908300098
[DEBUG] build_sequences: d_sequences=0x909640a00, d_num_sequences=0x908300098
[DEBUG] compress: Calling build_sequences for block 3 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=31,ML=65536,OF=1] [LL=65505,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905800000, d_match=0x905880000, d_off=0x906500000, d_seq=0x909a00c00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=13631488
[DEBUG] build_sequences: d_sequences=0x909a00c00, d_num_sequences=0x9083000a4
[DEBUG] build_sequences: d_sequences=0x909a00c00, d_num_sequences=0x9083000a4
[DEBUG] compress: Calling build_sequences for block 4 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=4999,ML=65536,OF=1] [LL=60537,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905a00000, d_match=0x905a80000, d_off=0x906600000, d_seq=0x909dc0e00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=12582912
[DEBUG] build_sequences: d_sequences=0x909dc0e00, d_num_sequences=0x9083000b0
[DEBUG] build_sequences: d_sequences=0x909dc0e00, d_num_sequences=0x9083000b0
[DEBUG] compress: Calling build_sequences for block 5 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=4999,ML=65536,OF=1] [LL=60537,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905c00000, d_match=0x905c80000, d_off=0x906700000, d_seq=0x90a181000
[DEBUG] Pointer deltas: match-lit=524288, off-lit=11534336
[DEBUG] build_sequences: d_sequences=0x90a181000, d_num_sequences=0x9083000bc
[DEBUG] build_sequences: d_sequences=0x90a181000, d_num_sequences=0x9083000bc
[DEBUG] compress: Calling build_sequences for block 6 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=3073,ML=65536,OF=1] [LL=62463,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905e00000, d_match=0x905e80000, d_off=0x906800000, d_seq=0x90a541200
[DEBUG] Pointer deltas: match-lit=524288, off-lit=10485760
[DEBUG] build_sequences: d_sequences=0x90a541200, d_num_sequences=0x9083000c8
[DEBUG] build_sequences: d_sequences=0x90a541200, d_num_sequences=0x9083000c8
[DEBUG] compress: Calling build_sequences for block 7 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=1,ML=65536,OF=1] [LL=0,ML=65535,OF=1] 
[DEBUG] Pointers: d_lit=0x906000000, d_match=0x906080000, d_off=0x906900000, d_seq=0x90a901400
[DEBUG] Pointer deltas: match-lit=524288, off-lit=9437184
[DEBUG] build_sequences: d_sequences=0x90a901400, d_num_sequences=0x9083000d4
[DEBUG] build_sequences: d_sequences=0x90a901400, d_num_sequences=0x9083000d4
❌ Decompression failed: 5
Zeros                |      1048576 |       459037 |       0.00:1

=== Testing: Random ===
Input size: 1048576 bytes
[DEBUG] test_compression: d_compressed allocated at 0x903000000
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DIAG] get_compress_temp_size: input=1048576, total=106954752
[DEBUG] compress: input_ptr=0x903f00000, input_attr_err=0, type=2, input_is_device=1
[DEBUG] compress: d_output=0x903000000, max_size=2097152
[DIAG] compress: temp_size=106954752, total_used=74450432, remaining=32504320
[WARN] compress: write_skippable_header_kernel reported: invalid argument
[DIAG] sizeof(Match)=16, sizeof(ParseCost)=8, sizeof(Sequence)=16
[DIAG] block_size=131072, num_blocks=8, input_size=1048576
[DIAG] Element offset calculation: block_idx * block_size = 0 * 131072 = 0
[DIAG] call_workspace.d_matches base = 0x905400000
[DIAG] call_workspace.d_costs base = 0x906400000
[DIAG] block_ws.d_matches (after offset) = 0x905400000
[DIAG] block_ws.d_costs (after offset) = 0x906400000
[DIAG] Pointer delta: d_matches offset = 0 bytes
[DIAG] recycled_matches = 0x905400000 (cast from block_ws.d_matches)
[DIAG] recycled_costs = 0x906400000 (cast from block_ws.d_costs)
[DIAG] d_literal_lengths = 0x905400000
[DIAG] d_match_lengths = 0x905480000
[DIAG] d_offsets = 0x906400000
[DIAG] d_sequences = 0x9090c0600
[DIAG] Expected offset for d_match_lengths: 512KB = 524288 bytes
[DIAG] Actual offset: match - lit = 524288 bytes
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
, search_depth=128, hash_log=18[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128

[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[DEBUG] Block 5: num_seq=3, total_literals=131066
[DEBUG] Block 0: num_seq=1, total_literals=131072
[DEBUG] Block 2: num_seq=1, total_literals=131072
[DEBUG] Block 3: num_seq=2, total_literals=131068
[DEBUG] Block 4: num_seq=1, total_literals=131072
[HOST] Parallel find_matches Config: nice_length=65536, min_match=3, hash_log=18, chain_log=17, search_depth=128
[DEBUG] Block 1: num_seq=1, total_literals=131072
[KERNEL] Parallel Config Check: nice_length=65536, min_match=3, search_depth=128, hash_log=18
[DEBUG] Block 6: num_seq=1, total_literals=131072
[DEBUG] Block 7: num_seq=1, total_literals=131072

[PHASE2-START] Checking block_seq_ctxs[0] pointers:
[PHASE2-START] d_literal_lengths = 0x905400000
[PHASE2-START] d_match_lengths = 0x905480000
[PHASE2-START] Offset: match - lit = 524288 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=131072,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905400000, d_match=0x905480000, d_off=0x906400000, d_seq=0x9090c0600
[DEBUG] Pointer deltas: match-lit=524288, off-lit=16777216
[DEBUG] build_sequences: d_sequences=0x9090c0600, d_num_sequences=0x908500080
[DEBUG] build_sequences: d_sequences=0x9090c0600, d_num_sequences=0x908500080
[DEBUG] compress: Calling build_sequences for block 1 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=131072,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905600000, d_match=0x905680000, d_off=0x906500000, d_seq=0x909480800
[DEBUG] Pointer deltas: match-lit=524288, off-lit=15728640
[DEBUG] build_sequences: d_sequences=0x909480800, d_num_sequences=0x90850008c
[DEBUG] build_sequences: d_sequences=0x909480800, d_num_sequences=0x90850008c
[DEBUG] compress: Calling build_sequences for block 2 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=131072,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905800000, d_match=0x905880000, d_off=0x906600000, d_seq=0x909840a00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=14680064
[DEBUG] build_sequences: d_sequences=0x909840a00, d_num_sequences=0x908500098
[DEBUG] build_sequences: d_sequences=0x909840a00, d_num_sequences=0x908500098
[DEBUG] compress: Calling build_sequences for block 3 with num_sequences=2\n[DEBUG] First 5 sequences: [LL=4637,ML=4,OF=3491] [LL=126431,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905a00000, d_match=0x905a80000, d_off=0x906700000, d_seq=0x909c00c00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=13631488
[DEBUG] build_sequences: d_sequences=0x909c00c00, d_num_sequences=0x9085000a4
[DEBUG] build_sequences: d_sequences=0x909c00c00, d_num_sequences=0x9085000a4
[DEBUG] compress: Calling build_sequences for block 4 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=131072,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905c00000, d_match=0x905c80000, d_off=0x906800000, d_seq=0x909fc0e00
[DEBUG] Pointer deltas: match-lit=524288, off-lit=12582912
[DEBUG] build_sequences: d_sequences=0x909fc0e00, d_num_sequences=0x9085000b0
[DEBUG] build_sequences: d_sequences=0x909fc0e00, d_num_sequences=0x9085000b0
[DEBUG] compress: Calling build_sequences for block 5 with num_sequences=3\n[DEBUG] First 5 sequences: [LL=1949,ML=3,OF=588] [LL=1130,ML=3,OF=511] [LL=127987,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x905e00000, d_match=0x905e80000, d_off=0x906900000, d_seq=0x90a381000
[DEBUG] Pointer deltas: match-lit=524288, off-lit=11534336
[DEBUG] build_sequences: d_sequences=0x90a381000, d_num_sequences=0x9085000bc
[DEBUG] build_sequences: d_sequences=0x90a381000, d_num_sequences=0x9085000bc
[DEBUG] compress: Calling build_sequences for block 6 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=131072,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x906000000, d_match=0x906080000, d_off=0x906a00000, d_seq=0x90a741200
[DEBUG] Pointer deltas: match-lit=524288, off-lit=10485760
[DEBUG] build_sequences: d_sequences=0x90a741200, d_num_sequences=0x9085000c8
[DEBUG] build_sequences: d_sequences=0x90a741200, d_num_sequences=0x9085000c8
[DEBUG] compress: Calling build_sequences for block 7 with num_sequences=1\n[DEBUG] First 5 sequences: [LL=131072,ML=0,OF=0] 
[DEBUG] Pointers: d_lit=0x906200000, d_match=0x906280000, d_off=0x906b00000, d_seq=0x90ab01400
[DEBUG] Pointer deltas: match-lit=524288, off-lit=9437184
[DEBUG] build_sequences: d_sequences=0x90ab01400, d_num_sequences=0x9085000d4
[DEBUG] build_sequences: d_sequences=0x90ab01400, d_num_sequences=0x9085000d4
❌ Decompression failed: 5
Random               |      1048576 |      1048630 |       0.00:1

✅ Comparison test PASSED
   • The 'zero sequences' issue in benchmark_lz77 was due to random test data
   • Random data (high entropy) compresses poorly as expected

✅ Phase 1 COMPLETE: Validation with Compressible Data

