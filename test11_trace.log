Using CUDA device: NVIDIA GeForce RTX 5080 Laptop GPU
Compute capability: 12.0
Total memory: 16302 MB
========================================
  FSE Advanced Features Test Suite
========================================


========================================
TEST 1: Low Entropy (Repetitive)
========================================

--- Feature 1 & 2: Adaptive + Accurate ---
--- Feature 3: GPU Optimization ---

[DEBUG] >>> ENCODE_FSE_ADVANCED_DEBUG ENTRY <<< input_size=40
[DEBUG] Step 2 Analysis: unique=1 entropy=0.000000 recommended_log=5
[DEBUG] Step 2 Adjusted: table_log=5 table_size=32
[DEBUG] Step 4 Memcpy Prep: dim=65 size=144
[DEBUG] Step 4 Memcpy: dst=0x90ba00200 src=0x5592a4b0f7c0 size=144 max_sym=65
[ENCODE] Writing final state: 0 (raw 32) - 5 bits

========================================
TEST 2: Medium Entropy (Text)
========================================

--- Feature 1 & 2: Adaptive + Accurate ---
--- Feature 3: GPU Optimization ---

[DEBUG] >>> ENCODE_FSE_ADVANCED_DEBUG ENTRY <<< input_size=45
[DEBUG] Step 2 Analysis: unique=29 entropy=4.441093 recommended_log=5
[DEBUG] Step 2 Adjusted: table_log=5 table_size=32
[DEBUG] Step 4 Memcpy Prep: dim=122 size=258
[DEBUG] Step 4 Memcpy: dst=0x902c00200 src=0x5592a4208230 size=258 max_sym=122
[ENCODE] Writing final state: 23 (raw 55) - 5 bits

========================================
TEST 3: High Entropy (Mixed)
========================================

--- Feature 1 & 2: Adaptive + Accurate ---
--- Feature 3: GPU Optimization ---

[DEBUG] >>> ENCODE_FSE_ADVANCED_DEBUG ENTRY <<< input_size=41
[DEBUG] Step 2 Analysis: unique=41 entropy=5.357552 recommended_log=5
[DEBUG] Step 2 Adjusted: table_log=6 table_size=64
[DEBUG] Step 4 Memcpy Prep: dim=121 size=256
[DEBUG] Step 4 Memcpy: dst=0x902c00200 src=0x5592a4208230 size=256 max_sym=121
[ENCODE] Writing final state: 2 (raw 66) - 6 bits

========================================
TEST 4: Multi-Table FSE
========================================

Active Tables: 0x9
  ✓ LITERALS table
  ✓ CUSTOM table
[TEST4] === ENTRY test_bit_exact_fse_roundtrip ===
[TEST4] Testing FSE roundtrip with 11 bytes of data
[TEST4] Allocating d_input (11 bytes)...
[TEST4] d_input allocated: 0x902c00000
[TEST4] Allocating d_output...
[TEST4] d_output allocated: 0x902c00200
[TEST4] Copying 11 bytes to d_input...
[TEST4] Data copied to device
[TEST4] === CALLING encode_fse_advanced_debug ===

[DEBUG] >>> ENCODE_FSE_ADVANCED_DEBUG ENTRY <<< input_size=11
[DEBUG] Step 2 Analysis: unique=6 entropy=2.299896 recommended_log=5
[DEBUG] Step 2 Adjusted: table_log=5 table_size=32
[DEBUG] Step 4 Memcpy Prep: dim=6 size=26
[DEBUG] Step 4 Memcpy: dst=0x902c00200 src=0x5592a3eb51e0 size=26 max_sym=6
[ENC] i=0 sym=1 st_in=32 bits=3 val=0 st_out=46
[ENC] i=1 sym=2 st_in=46 bits=3 val=6 st_out=60
[ENC] i=2 sym=3 st_in=60 bits=4 val=12 st_out=33
[ENC] i=3 sym=4 st_in=33 bits=3 val=1 st_out=47
[ENC] i=4 sym=5 st_in=47 bits=2 val=3 st_out=43
[ENC] i=5 sym=5 st_in=43 bits=2 val=3 st_out=39
[ENC] i=6 sym=5 st_in=39 bits=2 val=3 st_out=34
[ENC] i=7 sym=6 st_in=34 bits=1 val=0 st_out=50
[ENC] i=8 sym=6 st_in=50 bits=2 val=2 st_out=36
[ENC] i=9 sym=6 st_in=36 bits=1 val=0 st_out=54
[ENC] i=10 sym=6 st_in=54 bits=2 val=2 st_out=40
[ENCODE] Writing final state: 8 (raw 40) - 5 bits
[TEST4] === RETURNED from encode_fse_advanced_debug, status=0 ===
[TEST4] Encoding SUCCESS
Encoded to 30 bytes
[TEST4] Allocating d_decoded (11 bytes)...
[TEST4] d_decoded allocated: 0x902c00a00
[TEST4] === CALLING decode_fse ===
CTable: total_freq=32, table_size=32
CTable Freqs: [0]=0, [1]=3, [2]=3, [3]=3
[DECODE] Found terminator at bit 30 (byte 3, bit 6)
[DECODE] Initial state read from bitstream: 8 (table_log=5)
[DEC] i=10 sym=6 st_in=8 bits=2 new=1 st_out=21
[DEC] i=9 sym=5 st_in=21 bits=2 new=0 st_out=28
[DEC] i=8 sym=2 st_in=28 bits=3 new=2 st_out=10
[DEC] i=7 sym=3 st_in=10 bits=3 new=2 st_out=2
[DEC] i=6 sym=5 st_in=2 bits=2 new=1 st_out=5
[DEC] i=5 sym=2 st_in=5 bits=4 new=15 st_out=31
[DEC] i=4 sym=6 st_in=31 bits=1 new=1 st_out=11
[DEC] i=3 sym=5 st_in=11 bits=2 new=0 st_out=12
[DEC] i=2 sym=5 st_in=12 bits=2 new=3 st_out=19
[DEC] i=1 sym=2 st_in=19 bits=3 new=4 st_out=4
[DEC] i=0 sym=6 st_in=4 bits=2 new=3 st_out=19
[TEST4] === RETURNED from decode_fse, status=0 ===
[TEST4] Decoded to 11 bytes (expected 11)
[TEST4] Checking decoded_size == data_size...
[TEST4] Size check passed
[TEST4] Copying decoded data to host...
[TEST4] Decoded data copied to host
[TEST4] Verifying 11 bytes...
[TEST4] MISMATCH at byte 0: decoded=0x06 expected=0x01
test_fse_advanced: /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/tests/test_fse_advanced.cu:153: void test_bit_exact_fse_roundtrip(): Assertion `decoded_data[i] == test_data[i]' failed.
