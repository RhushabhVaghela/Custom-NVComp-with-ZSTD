========= COMPUTE-SANITIZER
========================================
Compressible Data Validation Tests
========================================

Objective: Prove system DOES compress when given compressible data
Context: benchmark_lz77 showed 'zero sequences' with random data


=== Testing: Repeated Text (64KB) ===
Input size: 65536 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=526\n========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x1482b] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_repeated_text() [0xe79d] in test_compressible_data
=========         Host Frame: main [0x9877] in test_compressible_data
========= 
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x14843] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_repeated_text() [0xe79d] in test_compressible_data
=========         Host Frame: main [0x9877] in test_compressible_data
========= 
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x1485b] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_repeated_text() [0xe79d] in test_compressible_data
=========         Host Frame: main [0x9877] in test_compressible_data
========= 
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x14873] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_repeated_text() [0xe79d] in test_compressible_data
=========         Host Frame: main [0x9877] in test_compressible_data
========= 
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x148a6] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_repeated_text() [0xe79d] in test_compressible_data
=========         Host Frame: main [0x9877] in test_compressible_data
========= 
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaGetLastError.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::sequence::build_sequences(cuda_zstd::sequence::SequenceContext const&, unsigned int, unsigned int, unsigned int, CUstream_st*) [0x341ca] in test_compressible_data
=========         Host Frame: cuda_zstd::DefaultZstdManager::compress(void const*, unsigned long, void*, unsigned long*, void*, unsigned long, void const*, unsigned long, CUstream_st*) [0x222e5] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe3b2] in test_compressible_data
=========         Host Frame: test_json_pattern() [0xf19d] in test_compressible_data
=========         Host Frame: main [0x987c] in test_compressible_data
========= 
✅ Compressed: 9034 bytes
✅ Compression ratio: 7.25:1
✅ Round-trip verified!
✅ Repeated text test PASSED

=== Testing: JSON Pattern (64KB) ===
Input size: 65536 bytes
[DEBUG] compress: Calling build_sequences for block 0 with num_sequences=3054\n[ERROR] ERROR_CUDA_ERROR at /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/src/cuda_zstd_sequence.cu:100 in build_sequences() (CUDA: invalid argument)
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x1482b] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_json_pattern() [0xf19d] in test_compressible_data
=========         Host Frame: main [0x987c] in test_compressible_data
========= 
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x14843] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_json_pattern() [0xf19d] in test_compressible_data
=========         Host Frame: main [0x987c] in test_compressible_data
========= 
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x1485b] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_json_pattern() [0xf19d] in test_compressible_data
=========         Host Frame: main [0x987c] in test_compressible_data
========= 
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x14873] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_json_pattern() [0xf19d] in test_compressible_data
=========         Host Frame: main [0x987c] in test_compressible_data
========= 
========= Program hit cudaErrorInvalidValue (error 1) due to "invalid argument" on CUDA API call to cudaFree.
=========     Saved host backtrace up to driver entry point at error
=========         Host Frame: cuda_zstd::DefaultZstdManager::~DefaultZstdManager() [0x148a6] in test_compressible_data
=========         Host Frame: test_compression(std::vector<unsigned char, std::allocator<unsigned char> > const&, char const*) [0xe484] in test_compressible_data
=========         Host Frame: test_json_pattern() [0xf19d] in test_compressible_data
=========         Host Frame: main [0x987c] in test_compressible_data
========= 
test_compressible_data: /mnt/d/Research Experiments/TDPE_and_GPU_loading/NVComp with ZSTD/tests/test_compressible_data.cu:246: bool test_json_pattern(): Assertion `result.success && "Compression should succeed"' failed.
========= Error: process didn't terminate successfully
========= Target application returned an error
========= ERROR SUMMARY: 11 errors
